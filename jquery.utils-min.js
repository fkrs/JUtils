(function(d){var c={draw:function(b){var a=d("<link></link>");d("<img></img>").attr("src",b).on("load",function(){var b=document.createElement("canvas");b.width=this.width;b.height=this.height;b.getContext("2d").drawImage(this,0,0);a.attr("href",b.toDataURL("image/png"));a.attr("rel","shortcut icon");a.attr("type","image/png");a.appendTo("head")});return a},remove:function(){d('link[rel="icon"],link[rel="short icon"]').remove()},_animateList:[],_animateCount:0,_animateIndex:0,_animateInterval:null,
animate:function(){var b=c._animateIndex;c._animateIndex=(c._animateIndex+1)%c._animateCount;if(c._animateList[b]){d('link[rel="icon"],link[rel="short icon"]').remove();var a=d("<link></link>");a.attr("href",c._animateList[b]);a.attr("rel","shortcut icon");a.attr("type","image/png");a.appendTo("head")}},animateLoadURL:function(b,a){d("<img></img>").attr("src",b).on("load",function(){var b=document.createElement("canvas");b.width=this.width;b.height=this.height;b.getContext("2d").drawImage(this,0,
0);c._animateList[a]=b.toDataURL("image/png")})},addAnimation:function(b){c.animateLoadURL(b,c._animateCount);c._animateCount++},animationLength:function(){return c._animateCount},startAnimation:function(b){null!==c._animateInterval&&clearInterval(c._animateInterval);c._animateInterval=setInterval(c.animate,b)},stopAnimation:function(){null!==c._animateInterval&&clearInterval(c._animateInterval)}},f=function(){var b=window.localStorage||window.sessionStorage||{_engineName:"internal",_items:{},getItem:function(a){return this._items[a]?
this._items[a]:null},setItem:function(a,b){this._items[a]=b},removeItem:function(a){this._items[a]=null}};return{getEngineName:function(){if(b._engineName)return b._engineName;if(window.localStorage)return"localStorage";if(window.sessionStorage)return"sessionStorage"},timestamp:function(){return Date.getTime?Date.getTime():+new Date},get:function(a){a=b.getItem(a);if(null!==a){var c=JSON.parse(a);if(c&&c.timeout)return c.timeout>=this.timestamp()?c.data:null}return a},set:function(a,c,e){e=1E3*(e||
3600);c={data:c,timeout:this.timestamp()+e};return b.setItem(a,JSON.stringify(c))},isset:function(a){a=b.getItem(a);return null!==a&&(a=JSON.parse(a))&&a.timeout&&a.timeout>=this.timestamp()?!0:!1},unset:function(a){return b.removeItem(a)},touch:function(a,c){var e=b.getItem(a);return null!==e&&(e=JSON.parse(e))&&e.timeout&&e.timeout>=this.timestamp()?this.set(a,e,c):!1},getValid:function(a){a=b.getItem(a);if(null!==a){a=JSON.parse(a);var c=this.timestamp();if(a&&a.timeout&&a.timeout>=c)return(a.timeout-
c)/1E3}return!1}}}();d.extend({faviconAdd:function(b){c.remove();c.draw(b)},faviconAnimationAdd:function(b){c.addAnimation(b)},faviconAnimationStart:function(b){c.startAnimation(b)},faviconAnimationStop:function(){c.stopAnimation()},imageToCanvas:function(b){var a=document.createElement("canvas"),c=d("<img></img>").attr("src",b).on("load",function(){var b=c.get(0);a.width=b.width;a.height=b.height;a.getContext("2d").drawImage(b,0,0)});return d(a)},storage:{getEngineName:function(){return f.getEngineName()},
get:function(b){return f.get(b)},set:function(b,a,c){return f.set(b,a,c)},isset:function(b){return f.isset(b)},unset:function(b){return f.unset(b)},touch:function(b,a){return f.touch(b,a)},getValid:function(b){return f.getValid(b)}}});d.fn.extend({faviconAdd:function(){return this.each(function(){c.remove();c.draw(d(this).attr("src"))})},faviconAnimationAdd:function(b){b=b||{};!0===b.start&&c.startAnimation(b.delay||250);return this.each(function(){c.addAnimation(d(this).attr("src"))})},imageToCanvas:function(b){return this.each(function(){var a=
document.createElement("canvas");a.width=this.width;a.height=this.height;a.getContext("2d").drawImage(this,0,0);return d(a).appendTo(b)})}})})(jQuery);